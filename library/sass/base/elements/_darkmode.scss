@mixin darkMode() {
	filter: invert(1) hue-rotate(180deg);

	// tweak color on some elements
	.site-header,
	.card {
		background-color: $mediumlight;
	}

	::selection {
		background-color: $medium;
	}

	// flip some elements back to normal
	.site-footer,
	.main-nav-container,
	.toggled .menu-toggle,
	img,
	iframe,
	video {
		filter: invert(1) hue-rotate(180deg);
	}

	.toggle-mode .icon-sun {
		background: transparent;
		color: $black;
	}

	.toggle-mode .icon-moon {
		background: $dark;
		color: $white;
	}
}

// if switcher has added .dark, do Dark Mode
.dark {
	@include darkMode;
}

// if system preference is dark, and switcher hasn't specified .light, do Dark Mode
@media (prefers-color-scheme: dark) {

	html:not(.light) {
		@include darkMode;
	}
}

// allow transition to be smooth
body,
.site-footer,
.main-nav-container,
.toggled .menu-toggle,
img,
iframe,
video {
	transition: filter 0.125s;
}

// improve performance on large areas
// (excluding img in particular, which caused a weird bug in Safari)
body,
.site-footer,
.main-nav-container {
	will-change: filter;
}